{"timestamp":"2026-01-07T12:17:41.569203Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_64e5a619c23d","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.569494Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_64e5a619c23d"}}
{"timestamp":"2026-01-07T12:17:41.569547Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_64e5a619c23d","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.569645Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_64e5a619c23d"}}
{"timestamp":"2026-01-07T12:17:41.580729Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"127.0.0.1","command":"MAIL","session_id":"sess_64e5a619c23d","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.580956Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_64e5a619c23d"}}
{"timestamp":"2026-01-07T12:17:41.592056Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient@example.com\u003e"],"client_ip":"127.0.0.1","command":"RCPT","session_id":"sess_64e5a619c23d","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.592178Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_64e5a619c23d"}}
{"timestamp":"2026-01-07T12:17:41.602905Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"DATA","session_id":"sess_64e5a619c23d","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.60296Z","level":"INFO","message":"SMTP message processing started","fields":{"client_ip":"127.0.0.1","mail_from":"sender@example.com","rcpt_count":1,"rcpt_to":["recipient@example.com"],"session_id":"sess_64e5a619c23d"}}
{"timestamp":"2026-01-07T12:17:41.603022Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"354 End data with \u003cCR\u003e\u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e","response_code":"354","session_id":"sess_64e5a619c23d"}}
2026/01/07 13:17:41 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-integration-test-2360879236/new/1767788261.1767788261603263_51115_1.DeepThought.local
2026/01/07 13:17:41 Message stored locally: from=sender@example.com to=[recipient@example.com] size=50
{"timestamp":"2026-01-07T12:17:41.603677Z","level":"INFO","message":"SMTP message stored successfully","fields":{"client_ip":"127.0.0.1","duration_ms":0,"mail_from":"sender@example.com","message_size":50,"rcpt_to":["recipient@example.com"],"session_id":"sess_64e5a619c23d","storage_type":"local"}}
{"timestamp":"2026-01-07T12:17:41.603719Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK Message accepted for delivery","response_code":"250","session_id":"sess_64e5a619c23d"}}
{"timestamp":"2026-01-07T12:17:41.614301Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_64e5a619c23d","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.614421Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_64e5a619c23d"}}
{"timestamp":"2026-01-07T12:17:41.614431Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":45,"session_id":"sess_64e5a619c23d"}}
{"timestamp":"2026-01-07T12:17:41.615246Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_7a15bf3764bd","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.615298Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_7a15bf3764bd"}}
{"timestamp":"2026-01-07T12:17:41.615333Z","level":"INFO","message":"SMTP command received","fields":{"args":["starttls.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_7a15bf3764bd","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.615382Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_7a15bf3764bd"}}
{"timestamp":"2026-01-07T12:17:41.626169Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_7a15bf3764bd","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.62625Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_7a15bf3764bd"}}
{"timestamp":"2026-01-07T12:17:41.626257Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":11,"session_id":"sess_7a15bf3764bd"}}
{"timestamp":"2026-01-07T12:17:41.627046Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_316247bb5c58","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.627087Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_316247bb5c58"}}
{"timestamp":"2026-01-07T12:17:41.627137Z","level":"INFO","message":"SMTP command received","fields":{"args":["noauth.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_316247bb5c58","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.627217Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-8BITMIME\r\n250-SIZE","session_id":"sess_316247bb5c58"}}
{"timestamp":"2026-01-07T12:17:41.63831Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_316247bb5c58","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.638389Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_316247bb5c58"}}
{"timestamp":"2026-01-07T12:17:41.638405Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":11,"session_id":"sess_316247bb5c58"}}
{"timestamp":"2026-01-07T12:17:41.639283Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_f36be4c2a355","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.639312Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_f36be4c2a355"}}
{"timestamp":"2026-01-07T12:17:41.639356Z","level":"INFO","message":"SMTP command received","fields":{"args":["no8bit.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_f36be4c2a355","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.6394Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_f36be4c2a355"}}
{"timestamp":"2026-01-07T12:17:41.649679Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_f36be4c2a355","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.649766Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_f36be4c2a355"}}
{"timestamp":"2026-01-07T12:17:41.649774Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":10,"session_id":"sess_f36be4c2a355"}}
{"timestamp":"2026-01-07T12:17:41.650543Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_fe54d17a38e2","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.650564Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_fe54d17a38e2"}}
{"timestamp":"2026-01-07T12:17:41.650605Z","level":"INFO","message":"SMTP command received","fields":{"args":["size.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_fe54d17a38e2","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.650657Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_fe54d17a38e2"}}
{"timestamp":"2026-01-07T12:17:41.661702Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_fe54d17a38e2","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.661768Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_fe54d17a38e2"}}
{"timestamp":"2026-01-07T12:17:41.661775Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":11,"session_id":"sess_fe54d17a38e2"}}
{"timestamp":"2026-01-07T12:17:41.662376Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_e8daa06f6e68","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.662393Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_e8daa06f6e68"}}
{"timestamp":"2026-01-07T12:17:41.662454Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_e8daa06f6e68","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.662489Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_e8daa06f6e68"}}
{"timestamp":"2026-01-07T12:17:41.673558Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cmail550@example.com\u003e"],"client_ip":"127.0.0.1","command":"MAIL","session_id":"sess_e8daa06f6e68","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.67369Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"127.0.0.1","error_code":550,"hostname":"","session_id":"sess_e8daa06f6e68","smtp_stage":"MAIL","trigger":"mail550@example.com"}}
{"timestamp":"2026-01-07T12:17:41.673721Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"127.0.0.1","response":"550 Requested action not taken: mailbox unavailable","response_code":"550","session_id":"sess_e8daa06f6e68"}}
{"timestamp":"2026-01-07T12:17:41.684375Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_e8daa06f6e68","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.684466Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_e8daa06f6e68"}}
{"timestamp":"2026-01-07T12:17:41.684487Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":22,"session_id":"sess_e8daa06f6e68"}}
{"timestamp":"2026-01-07T12:17:41.685359Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_be3969c6c85c","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.685375Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_be3969c6c85c"}}
{"timestamp":"2026-01-07T12:17:41.685422Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_be3969c6c85c","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.685474Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_be3969c6c85c"}}
{"timestamp":"2026-01-07T12:17:41.696524Z","level":"INFO","message":"SMTP command received","fields":{"args":["PLAIN","AGdvb2RhdXRoQGV4YW1wbGUuY29tAHBhc3N3b3Jk"],"client_ip":"127.0.0.1","command":"AUTH","session_id":"sess_be3969c6c85c","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.696574Z","level":"INFO","message":"SMTP authentication successful","fields":{"auth_mechanism":"PLAIN","client_ip":"127.0.0.1","session_id":"sess_be3969c6c85c","success":true,"username":"goodauth@example.com"}}
{"timestamp":"2026-01-07T12:17:41.696606Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"235 Authentication successful","response_code":"235","session_id":"sess_be3969c6c85c"}}
{"timestamp":"2026-01-07T12:17:41.707747Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_be3969c6c85c","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.707884Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_be3969c6c85c"}}
{"timestamp":"2026-01-07T12:17:41.707894Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":22,"session_id":"sess_be3969c6c85c"}}
{"timestamp":"2026-01-07T12:17:41.709991Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_64a2f034f416","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.710031Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.710068Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_64a2f034f416","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.710111Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.721213Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"127.0.0.1","command":"MAIL","session_id":"sess_64a2f034f416","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.721418Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.732512Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient1@example.com\u003e"],"client_ip":"127.0.0.1","command":"RCPT","session_id":"sess_64a2f034f416","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.732607Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.743701Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient2@example.com\u003e"],"client_ip":"127.0.0.1","command":"RCPT","session_id":"sess_64a2f034f416","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.74381Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.754903Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient3@example.com\u003e"],"client_ip":"127.0.0.1","command":"RCPT","session_id":"sess_64a2f034f416","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.755016Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.765143Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"DATA","session_id":"sess_64a2f034f416","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.765231Z","level":"INFO","message":"SMTP message processing started","fields":{"client_ip":"127.0.0.1","mail_from":"sender@example.com","rcpt_count":3,"rcpt_to":["recipient1@example.com","recipient2@example.com","recipient3@example.com"],"session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.765343Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"354 End data with \u003cCR\u003e\u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e","response_code":"354","session_id":"sess_64a2f034f416"}}
2026/01/07 13:17:41 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-integration-test-2360879236/new/1767788261.1767788261765442_51115_2.DeepThought.local
2026/01/07 13:17:41 Message stored locally: from=sender@example.com to=[recipient1@example.com recipient2@example.com recipient3@example.com] size=73
{"timestamp":"2026-01-07T12:17:41.765806Z","level":"INFO","message":"SMTP message stored successfully","fields":{"client_ip":"127.0.0.1","duration_ms":0,"mail_from":"sender@example.com","message_size":73,"rcpt_to":["recipient1@example.com","recipient2@example.com","recipient3@example.com"],"session_id":"sess_64a2f034f416","storage_type":"local"}}
{"timestamp":"2026-01-07T12:17:41.765824Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK Message accepted for delivery","response_code":"250","session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.776958Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_64a2f034f416","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.777105Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.777132Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":67,"session_id":"sess_64a2f034f416"}}
{"timestamp":"2026-01-07T12:17:41.777946Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_ce89c206fe90","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.777963Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_ce89c206fe90"}}
{"timestamp":"2026-01-07T12:17:41.778004Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_ce89c206fe90","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.778067Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_ce89c206fe90"}}
{"timestamp":"2026-01-07T12:17:41.788353Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"127.0.0.1","command":"MAIL","session_id":"sess_ce89c206fe90","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.788609Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_ce89c206fe90"}}
{"timestamp":"2026-01-07T12:17:41.799693Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient@example.com\u003e"],"client_ip":"127.0.0.1","command":"RCPT","session_id":"sess_ce89c206fe90","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.799837Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_ce89c206fe90"}}
{"timestamp":"2026-01-07T12:17:41.810917Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"DATA","session_id":"sess_ce89c206fe90","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.810966Z","level":"INFO","message":"SMTP message processing started","fields":{"client_ip":"127.0.0.1","mail_from":"sender@example.com","rcpt_count":1,"rcpt_to":["recipient@example.com"],"session_id":"sess_ce89c206fe90"}}
{"timestamp":"2026-01-07T12:17:41.811008Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"354 End data with \u003cCR\u003e\u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e","response_code":"354","session_id":"sess_ce89c206fe90"}}
2026/01/07 13:17:41 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-integration-test-2360879236/new/1767788261.1767788261811106_51115_3.DeepThought.local
2026/01/07 13:17:41 Message stored locally: from=sender@example.com to=[recipient@example.com] size=136
{"timestamp":"2026-01-07T12:17:41.811465Z","level":"INFO","message":"SMTP message stored successfully","fields":{"client_ip":"127.0.0.1","duration_ms":0,"mail_from":"sender@example.com","message_size":136,"rcpt_to":["recipient@example.com"],"session_id":"sess_ce89c206fe90","storage_type":"local"}}
{"timestamp":"2026-01-07T12:17:41.811478Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK Message accepted for delivery","response_code":"250","session_id":"sess_ce89c206fe90"}}
{"timestamp":"2026-01-07T12:17:41.821664Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_ce89c206fe90","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.821762Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_ce89c206fe90"}}
{"timestamp":"2026-01-07T12:17:41.82177Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":43,"session_id":"sess_ce89c206fe90"}}
{"timestamp":"2026-01-07T12:17:41.822802Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_1dc95bf042e4","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.822829Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_1dc95bf042e4"}}
{"timestamp":"2026-01-07T12:17:41.822891Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"127.0.0.1","command":"MAIL","session_id":"sess_1dc95bf042e4","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.822916Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"127.0.0.1","response":"503 Bad sequence - MAIL not allowed in HELO state","response_code":"503","session_id":"sess_1dc95bf042e4"}}
{"timestamp":"2026-01-07T12:17:41.822979Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_1dc95bf042e4","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.823007Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_1dc95bf042e4"}}
{"timestamp":"2026-01-07T12:17:41.823015Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":0,"session_id":"sess_1dc95bf042e4"}}
{"timestamp":"2026-01-07T12:17:41.82349Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_8030786779c8","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.823506Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_8030786779c8"}}
{"timestamp":"2026-01-07T12:17:41.823679Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_8030786779c8","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.823727Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_8030786779c8"}}
{"timestamp":"2026-01-07T12:17:41.835617Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"127.0.0.1","command":"MAIL","session_id":"sess_8030786779c8","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.835789Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_8030786779c8"}}
{"timestamp":"2026-01-07T12:17:41.847791Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient@example.com\u003e"],"client_ip":"127.0.0.1","command":"RCPT","session_id":"sess_8030786779c8","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.847924Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_8030786779c8"}}
{"timestamp":"2026-01-07T12:17:41.85819Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"RSET","session_id":"sess_8030786779c8","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.858309Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_8030786779c8"}}
{"timestamp":"2026-01-07T12:17:41.869333Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender2@example.com\u003e"],"client_ip":"127.0.0.1","command":"MAIL","session_id":"sess_8030786779c8","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.86952Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_8030786779c8"}}
{"timestamp":"2026-01-07T12:17:41.880641Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_8030786779c8","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:41.880725Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_8030786779c8"}}
{"timestamp":"2026-01-07T12:17:41.880733Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":57,"session_id":"sess_8030786779c8"}}
{"timestamp":"2026-01-07T12:17:41.88163Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"127.0.0.1","port":51022,"session_id":"sess_a095a2a6d64a","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:41.881658Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_a095a2a6d64a"}}
{"timestamp":"2026-01-07T12:17:41.88176Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"127.0.0.1","command":"EHLO","session_id":"sess_a095a2a6d64a","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:41.881818Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_a095a2a6d64a"}}
{"timestamp":"2026-01-07T12:17:41.892948Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"NOOP","session_id":"sess_a095a2a6d64a","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.893086Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"250 OK","response_code":"250","session_id":"sess_a095a2a6d64a"}}
{"timestamp":"2026-01-07T12:17:41.904411Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"127.0.0.1","command":"QUIT","session_id":"sess_a095a2a6d64a","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:41.904547Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"127.0.0.1","response":"221 Bye","response_code":"221","session_id":"sess_a095a2a6d64a"}}
{"timestamp":"2026-01-07T12:17:41.904556Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"127.0.0.1","duration_ms":22,"session_id":"sess_a095a2a6d64a"}}
goos: darwin
goarch: arm64
pkg: badsmtp
cpu: Apple M1 Max
BenchmarkSMTPSession-10            	  306025	      4368 ns/op	       0 B/op	       0 allocs/op
BenchmarkAuthenticationPLAIN-10    	  263488	      4908 ns/op	       0 B/op	       0 allocs/op
BenchmarkTLSHandshake-10           	  225136	      6266 ns/op	       0 B/op	       0 allocs/op
BenchmarkMessageStorage-10         	  269877	      4822 ns/op	       0 B/op	       0 allocs/op
PASS
ok  	badsmtp	6.580s
PASS
ok  	badsmtp/auth	0.348s
?   	badsmtp/cmd	[no test files]
?   	badsmtp/logging	[no test files]
2026/01/07 13:17:48 Generated self-signed certificate for hostname: test.example.com
2026/01/07 13:17:48 Generated self-signed certificate for hostname: 127.0.0.1
2026/01/07 13:17:48 Generated self-signed certificate for hostname: localhost
2026/01/07 13:17:48 Generated self-signed certificate for hostname: test.example.com
2026/01/07 13:17:48 Generated self-signed certificate for hostname: 127.0.0.1
2026/01/07 13:17:48 Generated self-signed certificate for hostname: ::1
2026/01/07 13:17:48 Generated self-signed certificate for hostname: mail.badsmtp.test
{"timestamp":"2026-01-07T12:17:48.716021Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_40c68d6a4c3a","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.716166Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_40c68d6a4c3a"}}
{"timestamp":"2026-01-07T12:17:48.71618Z","level":"INFO","message":"SMTP command received","fields":{"args":["size100000.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_40c68d6a4c3a","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.71623Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 100000\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_40c68d6a4c3a"}}
{"timestamp":"2026-01-07T12:17:48.716237Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_40c68d6a4c3a"}}
{"timestamp":"2026-01-07T12:17:48.727333Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_240131aa968b","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.727455Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_240131aa968b"}}
{"timestamp":"2026-01-07T12:17:48.727475Z","level":"INFO","message":"SMTP command received","fields":{"args":["size1.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_240131aa968b","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.72754Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 1000\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_240131aa968b"}}
{"timestamp":"2026-01-07T12:17:48.72755Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_240131aa968b"}}
{"timestamp":"2026-01-07T12:17:48.738622Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_81d711093827","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.738696Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_81d711093827"}}
{"timestamp":"2026-01-07T12:17:48.738711Z","level":"INFO","message":"SMTP command received","fields":{"args":["size20000000.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_81d711093827","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.738755Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10000000\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_81d711093827"}}
{"timestamp":"2026-01-07T12:17:48.738763Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_81d711093827"}}
{"timestamp":"2026-01-07T12:17:48.749307Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_c050c8e43bf2","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.749359Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_c050c8e43bf2"}}
{"timestamp":"2026-01-07T12:17:48.749391Z","level":"INFO","message":"SMTP command received","fields":{"args":["example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_c050c8e43bf2","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.749469Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_c050c8e43bf2"}}
{"timestamp":"2026-01-07T12:17:48.760546Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cmail550_5.1.1@example.com\u003e"],"client_ip":"pipe","command":"MAIL","session_id":"sess_c050c8e43bf2","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.760661Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":550,"hostname":"","session_id":"sess_c050c8e43bf2","smtp_stage":"MAIL","trigger":"mail550_5.1.1@example.com"}}
{"timestamp":"2026-01-07T12:17:48.760728Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_5621c8691486","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.760736Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"550 5.1.1 Requested action not taken: mailbox unavailable","response_code":"550","session_id":"sess_c050c8e43bf2"}}
{"timestamp":"2026-01-07T12:17:48.760739Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_5621c8691486"}}
{"timestamp":"2026-01-07T12:17:48.760768Z","level":"INFO","message":"SMTP command received","fields":{"args":["noenhancedstatuscodes.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_5621c8691486","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.760818Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_5621c8691486"}}
{"timestamp":"2026-01-07T12:17:48.771781Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cmail550_5.1.1@example.com\u003e"],"client_ip":"pipe","command":"MAIL","session_id":"sess_5621c8691486","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.771867Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":550,"hostname":"","session_id":"sess_5621c8691486","smtp_stage":"MAIL","trigger":"mail550_5.1.1@example.com"}}
{"timestamp":"2026-01-07T12:17:48.771896Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"550 Requested action not taken: mailbox unavailable","response_code":"550","session_id":"sess_5621c8691486"}}
{"timestamp":"2026-01-07T12:17:48.771912Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":11,"session_id":"sess_5621c8691486"}}
{"timestamp":"2026-01-07T12:17:48.782841Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":33,"session_id":"sess_c050c8e43bf2"}}
{"timestamp":"2026-01-07T12:17:48.793969Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_0cc90f28f2a5","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.794085Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_0cc90f28f2a5"}}
{"timestamp":"2026-01-07T12:17:48.794117Z","level":"INFO","message":"SMTP command received","fields":{"args":["authplain.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_0cc90f28f2a5","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.794253Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_0cc90f28f2a5"}}
{"timestamp":"2026-01-07T12:17:48.794261Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_0cc90f28f2a5"}}
{"timestamp":"2026-01-07T12:17:48.804902Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_3832ae3aa6ef","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.804973Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_3832ae3aa6ef"}}
{"timestamp":"2026-01-07T12:17:48.804993Z","level":"INFO","message":"SMTP command received","fields":{"args":["authlogin.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_3832ae3aa6ef","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.805114Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH LOGIN\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_3832ae3aa6ef"}}
{"timestamp":"2026-01-07T12:17:48.805127Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_3832ae3aa6ef"}}
{"timestamp":"2026-01-07T12:17:48.816175Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_693b1f49e409","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.816231Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_693b1f49e409"}}
{"timestamp":"2026-01-07T12:17:48.816247Z","level":"INFO","message":"SMTP command received","fields":{"args":["authcram.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_693b1f49e409","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.816302Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH CRAM-MD5 CRAM-SHA256\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_693b1f49e409"}}
{"timestamp":"2026-01-07T12:17:48.816316Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_693b1f49e409"}}
{"timestamp":"2026-01-07T12:17:48.827159Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_ea38ac804b5d","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.827216Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_ea38ac804b5d"}}
{"timestamp":"2026-01-07T12:17:48.827229Z","level":"INFO","message":"SMTP command received","fields":{"args":["authoauth.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_ea38ac804b5d","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.827287Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_ea38ac804b5d"}}
{"timestamp":"2026-01-07T12:17:48.827311Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_ea38ac804b5d"}}
{"timestamp":"2026-01-07T12:17:48.838368Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_ed88bfcb1785","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.838497Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_ed88bfcb1785"}}
{"timestamp":"2026-01-07T12:17:48.838526Z","level":"INFO","message":"SMTP command received","fields":{"args":["example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_ed88bfcb1785","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.838641Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_ed88bfcb1785"}}
{"timestamp":"2026-01-07T12:17:48.849556Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"pipe","command":"NOOP","session_id":"sess_ed88bfcb1785","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.849628Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_ed88bfcb1785"}}
{"timestamp":"2026-01-07T12:17:48.849637Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"pipe","command":"NOOP","session_id":"sess_ed88bfcb1785","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.849645Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_ed88bfcb1785"}}
{"timestamp":"2026-01-07T12:17:48.84965Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"pipe","command":"QUIT","session_id":"sess_ed88bfcb1785","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.849671Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"221 Bye","response_code":"221","session_id":"sess_ed88bfcb1785"}}
{"timestamp":"2026-01-07T12:17:48.849693Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":11,"session_id":"sess_ed88bfcb1785"}}
{"timestamp":"2026-01-07T12:17:48.901166Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_946e81c5daee","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.901192Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_946e81c5daee"}}
{"timestamp":"2026-01-07T12:17:48.901216Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_946e81c5daee","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.901227Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_946e81c5daee"}}
{"timestamp":"2026-01-07T12:17:48.901232Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_946e81c5daee"}}
{"timestamp":"2026-01-07T12:17:48.901246Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":6000,"session_id":"sess_d21cd826245c","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.901251Z","level":"INFO","message":"SMTP behaviour triggered","fields":{"behaviour":"immediate_drop","client_ip":"","port":6000,"session_id":"sess_d21cd826245c"}}
{"timestamp":"2026-01-07T12:17:48.901255Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_d21cd826245c"}}
{"timestamp":"2026-01-07T12:17:48.901279Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_44201c8c1fe6","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.901323Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_44201c8c1fe6"}}
{"timestamp":"2026-01-07T12:17:48.901329Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_44201c8c1fe6","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.90136Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_44201c8c1fe6"}}
{"timestamp":"2026-01-07T12:17:48.901368Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_44201c8c1fe6","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.901374Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_44201c8c1fe6"}}
{"timestamp":"2026-01-07T12:17:48.901378Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_44201c8c1fe6"}}
{"timestamp":"2026-01-07T12:17:48.901395Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_2ca2e28652cd","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.9014Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_2ca2e28652cd"}}
{"timestamp":"2026-01-07T12:17:48.901409Z","level":"INFO","message":"SMTP command received","fields":{"args":["noauth.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_2ca2e28652cd","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.901422Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-8BITMIME\r\n250-SIZE","session_id":"sess_2ca2e28652cd"}}
{"timestamp":"2026-01-07T12:17:48.901427Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_2ca2e28652cd","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.901433Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_2ca2e28652cd"}}
{"timestamp":"2026-01-07T12:17:48.901436Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_2ca2e28652cd"}}
{"timestamp":"2026-01-07T12:17:48.901449Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_f1e0528e2071","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.901454Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_f1e0528e2071"}}
{"timestamp":"2026-01-07T12:17:48.901463Z","level":"INFO","message":"SMTP command received","fields":{"args":["no8bit.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_f1e0528e2071","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.901475Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_f1e0528e2071"}}
{"timestamp":"2026-01-07T12:17:48.901484Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_f1e0528e2071","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.901489Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_f1e0528e2071"}}
{"timestamp":"2026-01-07T12:17:48.901492Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_f1e0528e2071"}}
{"timestamp":"2026-01-07T12:17:48.901503Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_df372263bd32","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.901507Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_df372263bd32"}}
{"timestamp":"2026-01-07T12:17:48.901515Z","level":"INFO","message":"SMTP command received","fields":{"args":["starttls.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_df372263bd32","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.90153Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_df372263bd32"}}
{"timestamp":"2026-01-07T12:17:48.901534Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_df372263bd32","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.90154Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_df372263bd32"}}
{"timestamp":"2026-01-07T12:17:48.901543Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_df372263bd32"}}
{"timestamp":"2026-01-07T12:17:48.901567Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_a2c866b22464","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.901581Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_a2c866b22464"}}
{"timestamp":"2026-01-07T12:17:48.901595Z","level":"INFO","message":"SMTP command received","fields":{"args":["size.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_a2c866b22464","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.901617Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_a2c866b22464"}}
{"timestamp":"2026-01-07T12:17:48.901625Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_a2c866b22464","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.901631Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_a2c866b22464"}}
{"timestamp":"2026-01-07T12:17:48.901636Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_a2c866b22464"}}
{"timestamp":"2026-01-07T12:17:48.901814Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_5e82607b2b4c","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.901831Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.901846Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_5e82607b2b4c","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.901861Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.901866Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"","command":"MAIL","session_id":"sess_5e82607b2b4c","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.901932Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.901938Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient@example.com\u003e"],"client_ip":"","command":"RCPT","session_id":"sess_5e82607b2b4c","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:48.901952Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.901957Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"DATA","session_id":"sess_5e82607b2b4c","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:48.901963Z","level":"INFO","message":"SMTP message processing started","fields":{"client_ip":"","mail_from":"sender@example.com","rcpt_count":1,"rcpt_to":["recipient@example.com"],"session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.901968Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"354 End data with \u003cCR\u003e\u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e","response_code":"354","session_id":"sess_5e82607b2b4c"}}
2026/01/07 13:17:48 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/TestSessionMailTransaction2637137217/001/new/1767788268.1767788268902196_51145_1.DeepThought.local
2026/01/07 13:17:48 Message stored locally: from=sender@example.com to=[recipient@example.com] size=0
{"timestamp":"2026-01-07T12:17:48.902569Z","level":"INFO","message":"SMTP message stored successfully","fields":{"client_ip":"","duration_ms":0,"mail_from":"sender@example.com","message_size":0,"rcpt_to":["recipient@example.com"],"session_id":"sess_5e82607b2b4c","storage_type":"local"}}
{"timestamp":"2026-01-07T12:17:48.902577Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250 OK Message accepted for delivery","response_code":"250","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.902582Z","level":"INFO","message":"SMTP command received","fields":{"args":["Test","Message"],"client_ip":"","command":"SUBJECT:","session_id":"sess_5e82607b2b4c","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.902587Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.902592Z","level":"INFO","message":"SMTP command received","fields":{"args":["is","a","test","message."],"client_ip":"","command":"THIS","session_id":"sess_5e82607b2b4c","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.902596Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.902604Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":".","session_id":"sess_5e82607b2b4c","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.902608Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.902613Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_5e82607b2b4c","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.90262Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.902624Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_5e82607b2b4c"}}
{"timestamp":"2026-01-07T12:17:48.903218Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_77b9378b2492","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.903235Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_77b9378b2492"}}
{"timestamp":"2026-01-07T12:17:48.903253Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_77b9378b2492","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.903275Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_77b9378b2492"}}
{"timestamp":"2026-01-07T12:17:48.903283Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cmail550@example.com\u003e"],"client_ip":"","command":"MAIL","session_id":"sess_77b9378b2492","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.903306Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"","error_code":550,"hostname":"","session_id":"sess_77b9378b2492","smtp_stage":"MAIL","trigger":"mail550@example.com"}}
{"timestamp":"2026-01-07T12:17:48.903313Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"550 Requested action not taken: mailbox unavailable","response_code":"550","session_id":"sess_77b9378b2492"}}
{"timestamp":"2026-01-07T12:17:48.903318Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_77b9378b2492","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.903326Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_77b9378b2492"}}
{"timestamp":"2026-01-07T12:17:48.903334Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_77b9378b2492"}}
{"timestamp":"2026-01-07T12:17:48.90335Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_ab507def3f53","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.903355Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_ab507def3f53"}}
{"timestamp":"2026-01-07T12:17:48.903366Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"","command":"MAIL","session_id":"sess_ab507def3f53","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.903381Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","response":"503 Bad sequence - MAIL not allowed in HELO state","response_code":"503","session_id":"sess_ab507def3f53"}}
{"timestamp":"2026-01-07T12:17:48.903385Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_ab507def3f53","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.903391Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_ab507def3f53"}}
{"timestamp":"2026-01-07T12:17:48.903395Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_ab507def3f53"}}
{"timestamp":"2026-01-07T12:17:48.903409Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_3081a225b770","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.903414Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_3081a225b770"}}
{"timestamp":"2026-01-07T12:17:48.903422Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_3081a225b770","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.90344Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_3081a225b770"}}
{"timestamp":"2026-01-07T12:17:48.903445Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"","command":"MAIL","session_id":"sess_3081a225b770","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.903496Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_3081a225b770"}}
{"timestamp":"2026-01-07T12:17:48.903503Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient@example.com\u003e"],"client_ip":"","command":"RCPT","session_id":"sess_3081a225b770","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:48.903517Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_3081a225b770"}}
{"timestamp":"2026-01-07T12:17:48.903522Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"RSET","session_id":"sess_3081a225b770","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:48.903527Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_3081a225b770"}}
{"timestamp":"2026-01-07T12:17:48.903532Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_3081a225b770","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.903538Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_3081a225b770"}}
{"timestamp":"2026-01-07T12:17:48.903541Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_3081a225b770"}}
{"timestamp":"2026-01-07T12:17:48.903554Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_fbe6c429aff6","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.903559Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_fbe6c429aff6"}}
{"timestamp":"2026-01-07T12:17:48.903571Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_fbe6c429aff6","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.903593Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_fbe6c429aff6"}}
{"timestamp":"2026-01-07T12:17:48.903598Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"NOOP","session_id":"sess_fbe6c429aff6","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.903604Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_fbe6c429aff6"}}
{"timestamp":"2026-01-07T12:17:48.903608Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_fbe6c429aff6","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.903614Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_fbe6c429aff6"}}
{"timestamp":"2026-01-07T12:17:48.903617Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_fbe6c429aff6"}}
{"timestamp":"2026-01-07T12:17:48.903953Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_b61cbff947fd","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.903959Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.90397Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_b61cbff947fd","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:48.903984Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.904005Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"","command":"MAIL","session_id":"sess_b61cbff947fd","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.904055Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.90406Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient@example.com\u003e"],"client_ip":"","command":"RCPT","session_id":"sess_b61cbff947fd","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:48.904072Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.904083Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"DATA","session_id":"sess_b61cbff947fd","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:48.90409Z","level":"INFO","message":"SMTP message processing started","fields":{"client_ip":"","mail_from":"sender@example.com","rcpt_count":1,"rcpt_to":["recipient@example.com"],"session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.904094Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"354 End data with \u003cCR\u003e\u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e","response_code":"354","session_id":"sess_b61cbff947fd"}}
2026/01/07 13:17:48 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/TestSessionWithMailbox1399918600/001/new/1767788268.1767788268904120_51145_2.DeepThought.local
2026/01/07 13:17:48 Message stored locally: from=sender@example.com to=[recipient@example.com] size=0
{"timestamp":"2026-01-07T12:17:48.904392Z","level":"INFO","message":"SMTP message stored successfully","fields":{"client_ip":"","duration_ms":0,"mail_from":"sender@example.com","message_size":0,"rcpt_to":["recipient@example.com"],"session_id":"sess_b61cbff947fd","storage_type":"local"}}
{"timestamp":"2026-01-07T12:17:48.904398Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250 OK Message accepted for delivery","response_code":"250","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.904403Z","level":"INFO","message":"SMTP command received","fields":{"args":["Test","Message"],"client_ip":"","command":"SUBJECT:","session_id":"sess_b61cbff947fd","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.904407Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.904411Z","level":"INFO","message":"SMTP command received","fields":{"args":["is","a","test","message."],"client_ip":"","command":"THIS","session_id":"sess_b61cbff947fd","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.904416Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.90442Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":".","session_id":"sess_b61cbff947fd","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.904424Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.904428Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_b61cbff947fd","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:48.904433Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.904436Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_b61cbff947fd"}}
{"timestamp":"2026-01-07T12:17:48.904943Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":4001,"session_id":"sess_8c5b555c913b","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:48.904951Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_8c5b555c913b"}}
{"timestamp":"2026-01-07T12:17:48.904963Z","level":"INFO","message":"SMTP behaviour triggered","fields":{"behaviour":"command_delay","client_ip":"","delay_seconds":1,"port":4001,"session_id":"sess_8c5b555c913b"}}
{"timestamp":"2026-01-07T12:17:49.906042Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_8c5b555c913b","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:49.906145Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_8c5b555c913b"}}
{"timestamp":"2026-01-07T12:17:49.906155Z","level":"INFO","message":"SMTP behaviour triggered","fields":{"behaviour":"command_delay","client_ip":"","delay_seconds":1,"port":4001,"session_id":"sess_8c5b555c913b"}}
{"timestamp":"2026-01-07T12:17:50.906675Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_8c5b555c913b","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.90678Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_8c5b555c913b"}}
{"timestamp":"2026-01-07T12:17:50.906788Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":2001,"session_id":"sess_8c5b555c913b"}}
{"timestamp":"2026-01-07T12:17:50.907087Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_289d70bc7b37","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:50.907095Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.907116Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_289d70bc7b37","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.907152Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.907159Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"","command":"MAIL","session_id":"sess_289d70bc7b37","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.907237Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.907242Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient@example.com\u003e"],"client_ip":"","command":"RCPT","session_id":"sess_289d70bc7b37","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:50.907261Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.907266Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"DATA","session_id":"sess_289d70bc7b37","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:50.907272Z","level":"INFO","message":"SMTP message processing started","fields":{"client_ip":"","mail_from":"sender@example.com","rcpt_count":1,"rcpt_to":["recipient@example.com"],"session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.907277Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"354 End data with \u003cCR\u003e\u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e","response_code":"354","session_id":"sess_289d70bc7b37"}}
2026/01/07 13:17:50 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/TestSessionDotStuffing3541389817/001/new/1767788270.1767788270907846_51145_3.DeepThought.local
2026/01/07 13:17:50 Message stored locally: from=sender@example.com to=[recipient@example.com] size=0
{"timestamp":"2026-01-07T12:17:50.908157Z","level":"INFO","message":"SMTP message stored successfully","fields":{"client_ip":"","duration_ms":0,"mail_from":"sender@example.com","message_size":0,"rcpt_to":["recipient@example.com"],"session_id":"sess_289d70bc7b37","storage_type":"local"}}
{"timestamp":"2026-01-07T12:17:50.908167Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250 OK Message accepted for delivery","response_code":"250","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.908176Z","level":"INFO","message":"SMTP command received","fields":{"args":["Test","Message"],"client_ip":"","command":"SUBJECT:","session_id":"sess_289d70bc7b37","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.908181Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.908186Z","level":"INFO","message":"SMTP command received","fields":{"args":["line","starts","with","two","dots"],"client_ip":"","command":"..THIS","session_id":"sess_289d70bc7b37","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.90819Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.908198Z","level":"INFO","message":"SMTP command received","fields":{"args":["line"],"client_ip":"","command":"NORMAL","session_id":"sess_289d70bc7b37","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.908202Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.908206Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":".","session_id":"sess_289d70bc7b37","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.90821Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.908213Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_289d70bc7b37","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.90822Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.908223Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":1,"session_id":"sess_289d70bc7b37"}}
{"timestamp":"2026-01-07T12:17:50.908804Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250 OK Test Response","response_code":"250","session_id":"sess_b0b458b923b5"}}
{"timestamp":"2026-01-07T12:17:50.90893Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_fd2a3c4a504b","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:50.908936Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.908951Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"","command":"EHLO","session_id":"sess_fd2a3c4a504b","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.908976Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.908981Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003csender@example.com\u003e"],"client_ip":"","command":"MAIL","session_id":"sess_fd2a3c4a504b","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.909039Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.909045Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient1@example.com\u003e"],"client_ip":"","command":"RCPT","session_id":"sess_fd2a3c4a504b","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:50.90906Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.909066Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crecipient2@example.com\u003e"],"client_ip":"","command":"RCPT","session_id":"sess_fd2a3c4a504b","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:50.909082Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","command":" (queued)","response":"250 OK","response_code":"250","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.909088Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"DATA","session_id":"sess_fd2a3c4a504b","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:50.909095Z","level":"INFO","message":"SMTP message processing started","fields":{"client_ip":"","mail_from":"sender@example.com","rcpt_count":2,"rcpt_to":["recipient1@example.com","recipient2@example.com"],"session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.9091Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"354 End data with \u003cCR\u003e\u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e","response_code":"354","session_id":"sess_fd2a3c4a504b"}}
2026/01/07 13:17:50 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/TestSessionMultipleRcptTo1524727375/001/new/1767788270.1767788270909273_51145_4.DeepThought.local
2026/01/07 13:17:50 Message stored locally: from=sender@example.com to=[recipient1@example.com recipient2@example.com] size=0
{"timestamp":"2026-01-07T12:17:50.909477Z","level":"INFO","message":"SMTP message stored successfully","fields":{"client_ip":"","duration_ms":0,"mail_from":"sender@example.com","message_size":0,"rcpt_to":["recipient1@example.com","recipient2@example.com"],"session_id":"sess_fd2a3c4a504b","storage_type":"local"}}
{"timestamp":"2026-01-07T12:17:50.909483Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"250 OK Message accepted for delivery","response_code":"250","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.909488Z","level":"INFO","message":"SMTP command received","fields":{"args":["Test","Message"],"client_ip":"","command":"SUBJECT:","session_id":"sess_fd2a3c4a504b","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.909492Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.909497Z","level":"INFO","message":"SMTP command received","fields":{"args":["is","a","test","message."],"client_ip":"","command":"THIS","session_id":"sess_fd2a3c4a504b","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.9095Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.909504Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":".","session_id":"sess_fd2a3c4a504b","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.909508Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","command":" (queued)","response":"500 Command not recognised","response_code":"500","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.909512Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_fd2a3c4a504b","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.909517Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.90952Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_fd2a3c4a504b"}}
{"timestamp":"2026-01-07T12:17:50.909936Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"","port":2525,"session_id":"sess_07076a569139","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:50.909941Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_07076a569139"}}
{"timestamp":"2026-01-07T12:17:50.909953Z","level":"INFO","message":"SMTP command received","fields":{"args":["COMMAND"],"client_ip":"","command":"INVALID","session_id":"sess_07076a569139","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.909957Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"","response":"500 Command not recognised","response_code":"500","session_id":"sess_07076a569139"}}
{"timestamp":"2026-01-07T12:17:50.909963Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"","command":"QUIT","session_id":"sess_07076a569139","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.909968Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"","response":"221 Bye","response_code":"221","session_id":"sess_07076a569139"}}
{"timestamp":"2026-01-07T12:17:50.909972Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"","duration_ms":0,"session_id":"sess_07076a569139"}}
{"timestamp":"2026-01-07T12:17:50.909986Z","level":"WARN","message":"Failed to load TLS certificate from files, generating self-signed","fields":{"cert_file":"","hostname":"localhost","key_file":"","session_id":"sess_65f9b5cd0d5b"}}
2026/01/07 13:17:50 Generated self-signed certificate for hostname: localhost
{"timestamp":"2026-01-07T12:17:50.948578Z","level":"WARN","message":"Failed to load TLS certificate from files, generating self-signed","fields":{"cert_file":"","hostname":"localhost","key_file":"","session_id":"sess_db1326d9f7b8"}}
2026/01/07 13:17:50 Generated self-signed certificate for hostname: localhost
{"timestamp":"2026-01-07T12:17:50.964582Z","level":"INFO","message":"TLS handshake successful","fields":{"cipher":"TLS_AES_128_GCM_SHA256","client_ip":"pipe","session_id":"sess_db1326d9f7b8","success":true,"tls_version":"TLS 1.3"}}
{"timestamp":"2026-01-07T12:17:50.96466Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_b90d8962d189","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:50.96468Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_b90d8962d189"}}
{"timestamp":"2026-01-07T12:17:50.964707Z","level":"INFO","message":"SMTP command received","fields":{"args":["exists@example.com"],"client_ip":"pipe","command":"VRFY","session_id":"sess_b90d8962d189","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.964732Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250 exists@example.com User exists","response_code":"250","session_id":"sess_b90d8962d189"}}
{"timestamp":"2026-01-07T12:17:50.96474Z","level":"INFO","message":"SMTP command received","fields":{"args":["unknown@example.com"],"client_ip":"pipe","command":"VRFY","session_id":"sess_b90d8962d189","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.964749Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"551 User not local; please try forward path","response_code":"551","session_id":"sess_b90d8962d189"}}
{"timestamp":"2026-01-07T12:17:50.964756Z","level":"INFO","message":"SMTP command received","fields":{"args":["ambiguous@example.com"],"client_ip":"pipe","command":"VRFY","session_id":"sess_b90d8962d189","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.964766Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"553 Requested action not taken: mailbox name not allowed","response_code":"553","session_id":"sess_b90d8962d189"}}
{"timestamp":"2026-01-07T12:17:50.964772Z","level":"INFO","message":"SMTP command received","fields":{"args":["other@example.com"],"client_ip":"pipe","command":"VRFY","session_id":"sess_b90d8962d189","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.964791Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"550 Requested action not taken: mailbox unavailable","response_code":"550","session_id":"sess_b90d8962d189"}}
{"timestamp":"2026-01-07T12:17:50.964806Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_b90d8962d189"}}
{"timestamp":"2026-01-07T12:17:50.964819Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_f3b927a808a8","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:50.964833Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_f3b927a808a8"}}
{"timestamp":"2026-01-07T12:17:50.975918Z","level":"INFO","message":"SMTP command received","fields":{"args":["\"Alice","Example\"","\u003cexists@example.com\u003e"],"client_ip":"pipe","command":"VRFY","session_id":"sess_f3b927a808a8","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.975997Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250 exists@example.com User exists","response_code":"250","session_id":"sess_f3b927a808a8"}}
{"timestamp":"2026-01-07T12:17:50.987041Z","level":"INFO","message":"SMTP command received","fields":{"args":["usr@.jp"],"client_ip":"pipe","command":"VRFY","session_id":"sess_f3b927a808a8","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.987192Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"550 Requested action not taken: mailbox unavailable","response_code":"550","session_id":"sess_f3b927a808a8"}}
{"timestamp":"2026-01-07T12:17:50.987207Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":22,"session_id":"sess_f3b927a808a8"}}
{"timestamp":"2026-01-07T12:17:50.987216Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_4ce816ac3664","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:50.98724Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_4ce816ac3664"}}
{"timestamp":"2026-01-07T12:17:50.987251Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_4ce816ac3664","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.987303Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_4ce816ac3664"}}
{"timestamp":"2026-01-07T12:17:50.998162Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cmail421@example.com\u003e"],"client_ip":"pipe","command":"MAIL","session_id":"sess_4ce816ac3664","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:50.998287Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":421,"hostname":"","session_id":"sess_4ce816ac3664","smtp_stage":"MAIL","trigger":"mail421@example.com"}}
{"timestamp":"2026-01-07T12:17:50.998313Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"421 Service not available, closing transmission channel","response_code":"421","session_id":"sess_4ce816ac3664"}}
{"timestamp":"2026-01-07T12:17:50.998329Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":11,"session_id":"sess_4ce816ac3664"}}
{"timestamp":"2026-01-07T12:17:50.998375Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_28bfa47bf236","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:50.998388Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_28bfa47bf236"}}
{"timestamp":"2026-01-07T12:17:50.998401Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_28bfa47bf236","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:50.998434Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_28bfa47bf236"}}
{"timestamp":"2026-01-07T12:17:51.008861Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cuser@example.com\u003e"],"client_ip":"pipe","command":"MAIL","session_id":"sess_28bfa47bf236","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:51.009052Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250 OK","response_code":"250","session_id":"sess_28bfa47bf236"}}
{"timestamp":"2026-01-07T12:17:51.020098Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003crcpt421@example.com\u003e"],"client_ip":"pipe","command":"RCPT","session_id":"sess_28bfa47bf236","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:51.020207Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":421,"hostname":"","session_id":"sess_28bfa47bf236","smtp_stage":"RCPT","trigger":"rcpt421@example.com"}}
{"timestamp":"2026-01-07T12:17:51.020226Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"421 Service not available, closing transmission channel","response_code":"421","session_id":"sess_28bfa47bf236"}}
{"timestamp":"2026-01-07T12:17:51.020233Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":21,"session_id":"sess_28bfa47bf236"}}
{"timestamp":"2026-01-07T12:17:51.020271Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_f64a11bc619a","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:51.020287Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_f64a11bc619a"}}
{"timestamp":"2026-01-07T12:17:51.020295Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_f64a11bc619a","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:51.020326Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_f64a11bc619a"}}
{"timestamp":"2026-01-07T12:17:51.031401Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cdata421@example.com\u003e"],"client_ip":"pipe","command":"MAIL","session_id":"sess_f64a11bc619a","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:51.031636Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250 OK","response_code":"250","session_id":"sess_f64a11bc619a"}}
{"timestamp":"2026-01-07T12:17:51.042709Z","level":"INFO","message":"SMTP command received","fields":{"args":["TO:\u003cuser@example.com\u003e"],"client_ip":"pipe","command":"RCPT","session_id":"sess_f64a11bc619a","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:51.04281Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250 OK","response_code":"250","session_id":"sess_f64a11bc619a"}}
{"timestamp":"2026-01-07T12:17:51.053866Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"pipe","command":"DATA","session_id":"sess_f64a11bc619a","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:51.053917Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":421,"hostname":"","session_id":"sess_f64a11bc619a","smtp_stage":"DATA","trigger":"data421@example.com"}}
{"timestamp":"2026-01-07T12:17:51.053934Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"421 Service not available, closing transmission channel","response_code":"421","session_id":"sess_f64a11bc619a"}}
{"timestamp":"2026-01-07T12:17:51.053942Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":33,"session_id":"sess_f64a11bc619a"}}
{"timestamp":"2026-01-07T12:17:51.054006Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_d743653e6912","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:51.054039Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_d743653e6912"}}
{"timestamp":"2026-01-07T12:17:51.054087Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_d743653e6912","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:51.054175Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_d743653e6912"}}
{"timestamp":"2026-01-07T12:17:51.065242Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003crset421@example.com\u003e"],"client_ip":"pipe","command":"MAIL","session_id":"sess_d743653e6912","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:51.065395Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250 OK","response_code":"250","session_id":"sess_d743653e6912"}}
{"timestamp":"2026-01-07T12:17:51.076434Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"pipe","command":"RSET","session_id":"sess_d743653e6912","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:51.076487Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":421,"hostname":"","session_id":"sess_d743653e6912","smtp_stage":"RSET","trigger":"rset421@example.com"}}
{"timestamp":"2026-01-07T12:17:51.076521Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"421 Service not available, closing transmission channel","response_code":"421","session_id":"sess_d743653e6912"}}
{"timestamp":"2026-01-07T12:17:51.076529Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":22,"session_id":"sess_d743653e6912"}}
{"timestamp":"2026-01-07T12:17:51.076575Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_eabbc16d7085","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:51.076597Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_eabbc16d7085"}}
{"timestamp":"2026-01-07T12:17:51.076612Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_eabbc16d7085","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:51.076653Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_eabbc16d7085"}}
{"timestamp":"2026-01-07T12:17:51.087719Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cnoop421@example.com\u003e"],"client_ip":"pipe","command":"MAIL","session_id":"sess_eabbc16d7085","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:51.087857Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250 OK","response_code":"250","session_id":"sess_eabbc16d7085"}}
{"timestamp":"2026-01-07T12:17:51.09889Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"pipe","command":"NOOP","session_id":"sess_eabbc16d7085","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:51.09894Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":421,"hostname":"","session_id":"sess_eabbc16d7085","smtp_stage":"NOOP","trigger":"noop421@example.com"}}
{"timestamp":"2026-01-07T12:17:51.098963Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"421 Service not available, closing transmission channel","response_code":"421","session_id":"sess_eabbc16d7085"}}
{"timestamp":"2026-01-07T12:17:51.09897Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":22,"session_id":"sess_eabbc16d7085"}}
{"timestamp":"2026-01-07T12:17:51.099061Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_400661bd594a","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:51.099108Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_400661bd594a"}}
{"timestamp":"2026-01-07T12:17:51.099122Z","level":"INFO","message":"SMTP command received","fields":{"args":["client.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_400661bd594a","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:51.09919Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250-badsmtp.test\r\n250-AUTH PLAIN LOGIN CRAM-MD5 CRAM-SHA256 XOAUTH2\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-PIPELINING\r\n250-STARTTLS\r\n250-CHUNKING\r\n250-SMTPUTF8\r\n250-ENHANCEDSTATUSCODES\r\n250 OK","response_code":"250-badsmtp.test\r\n250-AUTH","session_id":"sess_400661bd594a"}}
{"timestamp":"2026-01-07T12:17:51.110151Z","level":"INFO","message":"SMTP command received","fields":{"args":["FROM:\u003cquit421@example.com\u003e"],"client_ip":"pipe","command":"MAIL","session_id":"sess_400661bd594a","smtp_state":"MAIL"}}
{"timestamp":"2026-01-07T12:17:51.110293Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"250 OK","response_code":"250","session_id":"sess_400661bd594a"}}
{"timestamp":"2026-01-07T12:17:51.121337Z","level":"INFO","message":"SMTP command received","fields":{"client_ip":"pipe","command":"QUIT","session_id":"sess_400661bd594a","smtp_state":"RCPT"}}
{"timestamp":"2026-01-07T12:17:51.121401Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":421,"hostname":"","session_id":"sess_400661bd594a","smtp_stage":"QUIT","trigger":"quit421@example.com"}}
{"timestamp":"2026-01-07T12:17:51.121424Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"421 Service not available, closing transmission channel","response_code":"421","session_id":"sess_400661bd594a"}}
{"timestamp":"2026-01-07T12:17:51.121432Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":22,"session_id":"sess_400661bd594a"}}
{"timestamp":"2026-01-07T12:17:51.121485Z","level":"INFO","message":"SMTP connection established","fields":{"client_ip":"pipe","port":2525,"session_id":"sess_4bc2a174cc1c","tls_enabled":false}}
{"timestamp":"2026-01-07T12:17:51.121504Z","level":"INFO","message":"SMTP response sent","fields":{"client_ip":"pipe","response":"220 badsmtp.test ESMTP BadSMTP Server","response_code":"220","session_id":"sess_4bc2a174cc1c"}}
{"timestamp":"2026-01-07T12:17:51.121513Z","level":"INFO","message":"SMTP command received","fields":{"args":["helo421.example.com"],"client_ip":"pipe","command":"EHLO","session_id":"sess_4bc2a174cc1c","smtp_state":"HELO"}}
{"timestamp":"2026-01-07T12:17:51.121548Z","level":"WARN","message":"SMTP error simulation triggered","fields":{"client_ip":"pipe","error_code":421,"hostname":"","session_id":"sess_4bc2a174cc1c","smtp_stage":"EHLO","trigger":"helo421.example.com"}}
{"timestamp":"2026-01-07T12:17:51.121558Z","level":"WARN","message":"SMTP error response sent","fields":{"client_ip":"pipe","response":"421 Service not available, closing transmission channel","response_code":"421","session_id":"sess_4bc2a174cc1c"}}
{"timestamp":"2026-01-07T12:17:51.121563Z","level":"INFO","message":"SMTP connection closed","fields":{"client_ip":"pipe","duration_ms":0,"session_id":"sess_4bc2a174cc1c"}}
PASS
ok  	badsmtp/server	3.080s
PASS
ok  	badsmtp/smtp	0.316s
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-833924643/new/1767788271.1767788271818846_51157_1.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-4269248674/new/1767788271.1767788271820705_51157_2.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-297715703/new/1767788271.1767788271822362_51157_3.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-3001061530/new/1767788271.1767788271823858_51157_4.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-3744298438/new/1767788271.1767788271825132_51157_5.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-960545907/new/1767788271.1767788271826056_51157_6.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-1162320029/new/1767788271.1767788271827033_51157_7.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-1162320029/new/1767788271.1767788271838321_51157_8.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-1162320029/new/1767788271.1767788271849220_51157_9.DeepThought.local
2026/01/07 13:17:51 Message saved to /var/folders/wn/fk5c4mz15z56v0ztf3g4c5dh0000gn/T/badsmtp-test-2139142317/new/1767788271.1767788271861711_51157_10.DeepThought.local
PASS
ok  	badsmtp/storage	0.423s
